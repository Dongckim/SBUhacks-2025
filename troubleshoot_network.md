# 네트워크 접속 문제 해결 가이드

## "사이트에 연결할 수 없음" 오류 해결 방법

### 1단계: 서버가 실행 중인지 확인

백엔드 서버가 실행 중인지 확인하세요:

```bash
# 서버 실행
node server.js
```

서버가 정상적으로 실행되면 다음과 같은 메시지가 표시됩니다:
```
✅ 서버가 http://localhost:3001 에서 실행 중입니다.
🌐 네트워크 접속: http://<로컬-IP주소>:3001
✅ DB 연결 성공!
```

### 2단계: 로컬에서 테스트

먼저 **같은 컴퓨터**에서 접속이 되는지 확인:

브라우저에서:
```
http://localhost:3001/api/reports
```

이것도 안 되면 서버 문제입니다.

### 3단계: IP 주소 확인

로컬 IP 주소를 다시 확인:

```bash
npm run ip
```

또는:

```bash
# Mac
ipconfig getifaddr en0

# 또는 모든 IP 확인
ifconfig | grep "inet " | grep -v 127.0.0.1
```

### 4단계: 방화벽 확인

Mac 방화벽이 포트를 차단하고 있을 수 있습니다.

**방화벽 확인 방법:**
1. 시스템 설정 > 네트워크 > 방화벽
2. 방화벽이 켜져 있다면:
   - "옵션..." 클릭
   - "들어오는 연결 자동으로 허용" 체크
   - 또는 Node.js를 허용 목록에 추가

**임시 해결책 (개발용):**
```bash
# 방화벽을 일시적으로 끄기 (개발 환경에서만!)
# 프로덕션에서는 사용하지 마세요!
```

### 5단계: 포트 확인

다른 프로그램이 3001 포트를 사용하고 있는지 확인:

```bash
# Mac/Linux
lsof -i :3001

# 포트를 사용하는 프로세스가 있으면:
# kill -9 <PID>
```

포트가 사용 중이면 `.env` 파일에서 다른 포트로 변경:

```env
PORT=3002
```

### 6단계: 네트워크 연결 확인

**같은 네트워크에 있는지 확인:**
- 백엔드 컴퓨터와 프론트엔드 컴퓨터가 **같은 Wi-Fi**에 연결되어 있어야 합니다
- 다른 네트워크(예: 백엔드는 집 Wi-Fi, 프론트엔드는 핫스팟)면 접속 불가

**네트워크 확인:**
```bash
# 백엔드 컴퓨터에서
ping <프론트엔드-IP주소>

# 또는 프론트엔드 컴퓨터에서
ping <백엔드-IP주소>
```

### 7단계: 서버 로그 확인

서버 터미널에서 요청이 들어오는지 확인:

요청이 들어오면 로그가 표시됩니다:
```
SQL: SELECT ticket_id, issue_type, created_at, status FROM reports...
Params: [1]
```

요청이 전혀 안 들어오면 네트워크/방화벽 문제입니다.

### 8단계: curl로 테스트

프론트엔드 컴퓨터의 터미널에서:

```bash
# 같은 컴퓨터에서
curl http://localhost:3001/api/reports

# 다른 컴퓨터에서
curl http://192.168.1.15:3001/api/reports
```

curl이 작동하면 브라우저 문제이고, 안 되면 서버/네트워크 문제입니다.

## 빠른 체크리스트

- [ ] 서버가 실행 중인가? (`node server.js`)
- [ ] localhost에서 접속되는가? (`http://localhost:3001/api/reports`)
- [ ] IP 주소가 올바른가? (`npm run ip`)
- [ ] 같은 Wi-Fi 네트워크에 연결되어 있는가?
- [ ] 방화벽이 포트를 차단하지 않는가?
- [ ] 포트 3001이 사용 가능한가? (`lsof -i :3001`)

## 대안: ngrok 사용 (다른 네트워크에서 접속)

같은 네트워크가 아닌 경우, ngrok을 사용할 수 있습니다:

```bash
# ngrok 설치 (한 번만)
brew install ngrok

# 서버 실행 후 다른 터미널에서
ngrok http 3001
```

ngrok이 제공하는 URL (예: `https://abc123.ngrok.io`)을 프론트엔드에서 사용하세요.

